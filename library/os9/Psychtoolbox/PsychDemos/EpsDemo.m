function EpsDemo% EpsDemo shows how to save an image (grating in noise) to disk. If you% want to convert the EPS file to some other format, we recommend% using Adobe Illustrator, especially the "Export to Web" feature.% % Also see SaveAsEps, SCREEN 'SaveAsEps', SaveAsEpsTest, GratingDemo.% 8/31/00 dgp Wrote it, based on GratingDemo.m and SaveAsEpsTest.m.% 4/10/02  awi Added platform conditional to use SaveAsEps.m on windows.%			   Use font Arial instead of Helvetica because Arial is %			     available on both Win and Mac.% 3/1/03   dgp Also see ...% 7/15/03  dgp Added comments explaining f and lambda.% interesting parameterswidth=400; % pixelscheckpix=2; % check size of noise and gratingcnoise=0.2; % contrast of noisecsignal=.3; % contrast of gratingorientation=90;% tilt of grating (deg)f=6; % grating spatial frequency (cycles per image)checks=width/checkpix;f=f/checks; % grating spatial frequency (cycles per check)lambda=1.5/f; % gaussian space constant (in checks) of 1.5 cycleswhichScreen=0;% Need pixelSize of 8 for 'SaveAsEps'.window=Screen(whichScreen,'OpenWindow',[],[],8);white=WhiteIndex(window);black=BlackIndex(window);gray=(white+black)/2;if round(gray)==white	gray=black;endinc=white-gray;Screen(window,'FillRect',gray);% gratinghalf=(checks-1)/2;[x,y]=meshgrid(-half:half,-half:half);a=cos(orientation*pi/180)*2*pi*f;b=sin(orientation*pi/180)*2*pi*f;signal=exp(-((x/lambda).^2)-((y/lambda).^2)).*sin(a*x+b*y);rect=[0 0 size(signal,2) size(signal,1)];%rect=CenterRect(rect,Screen(window,'Rect'));% noisenoiseBound=1;noiseList=-1:1/1024:1;noisePowerFactor=std(noiseList,1)^2;x=-noiseBound:.01:noiseBound;pdf=ones(size(x));idealNoisePowerFactor=sum(pdf.*x.^2)/sum(pdf);noise=randsample(noiseList,size(signal));rect=rect*checkpix;Screen(window,'PutImage',gray+inc*(csignal*signal+cnoise*noise),rect);% Save image to disk.cd(diskroot);if IsOS9	cd(DesktopFolder);endpageRect=rect.*[1,-1,1,-1];% convert from Apple to Adobe coordinates% Win: Screen 'SaveAsEps' is not yet available so% we use SaveAsEps.m instead.  if IsWin	psimg = Screen(window,'GetImage',rect);	SaveAsEps('grating.eps',psimg,pageRect);else	Screen(window,'SaveAsEps','grating.eps',rect,pageRect);endfiletype('grating.eps','EPSF','ART5'); % to open in Adobe Illustrator% Center it on an 8.5"x11" page.% rect=Screen(window,'Rect');% paperRect=SetRect(0,11*72,8.5*72,0);% pageRect=rect.*[1,-1,1,-1];% convert from Apple to Adobe coordinates% pageRect=CenterRect(pageRect,paperRect);% Screen(window,'SaveAsEps','test.eps',rect,pageRect)% pauseScreen(window,'TextFont','Arial');Screen(window,'TextSize',18);Ask(window,'Done. Hit return to quit.',black,gray,'GetString');Screen(window,'Close');